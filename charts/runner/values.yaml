#################################################################
##  Global Configuration                                       ##
#################################################################
global:
  ## Gateway configuration
  gateway:
    ## GatewayClass controller that will reconcile Gateway / HTTPRoute resources.
    ## Choose the controller according to the Gateway implementation you use.
    ## Examples:
    ## - gateway.envoyproxy.io/gatewayclass-controller  (Envoy Gateway)
    ## - istio.io/gateway-controller                    (Istio)
    ## - io.cilium/gateway-controller                   (Cilium)
    controllerName: gateway.envoyproxy.io/gatewayclass-controller

    ## Gateway service configuration
    ## type: Service type (LoadBalancer or NodePort)
    ## nodePorts: Optional NodePort mapping (if using NodePort)
    service:
      type: "LoadBalancer"          # Service type: LoadBalancer or NodePort
      nodePorts: {}
        # http: 30080
        # https: 30443
        # gitssh: 30022

    ## Base external domain used to expose CSGHub services
    external:
      domain: "csghub.example.com"  # e.g. csghub.example.com, example.com
        # public: ""                  # Optional public access domain override.
        # If empty, the domain will be derived automatically.
        # NOTE: When base domain is a second-level domain (e.g. example.com),
        # a subdomain (e.g. csghub.example.com) will be used internally
        # to avoid overly broad wildcard routing such as *.example.com

    ## TLS/SSL configuration for Gateway
    tls:
      enabled: false                # Enable TLS termination on the Gateway
      # secretName: ""              # Kubernetes TLS secret name (required if TLS is enabled)

  ## Image management
  image:
    registry: "docker.io"           # Image global registry, opencsg-registry.cn-beijing.cr.aliyuncs.com for mainland
    registryPolicy: "default"       # default or force, force will overwrite all others registries
    tag: "v1.16.0"                  # Image tag format: {{version}}-{{edition}}
    pullPolicy: "IfNotPresent"      # Image pull policy: Always, IfNotPresent, Never
    pullSecrets: []                 # Private registry authentication secrets

  ## Disable internal Registry (It's Only a flag)
  registry:
    enabled: false

  ## Disable internal ObjectStore (It's Only a flag)
  objectStore:
    enabled: false

  ## SubChart deployment context
  chartContext:
    isBuiltIn: false                     # deployed bundled with csghub

#################################################################
##  CSGHub Configuration                                       ##
#################################################################
## External CSGHub URL for accessing the hub interface
externalUrl: "https://csghub.example.com"

## Global image configuration
image:
  # registry: "docker.io"                    # Docker registry
  repository: "opencsghq/csghub-server"
  tag: "v1.16.0"                           # Image version tag
  pullPolicy: "IfNotPresent"               # Image pull policy: Always, IfNotPresent, Never
  pullSecrets: []                          # Docker registry secrets

## Gateway configuration
gateway:
  enabled: true                            # Enable or disable gateway
  tls: {}                                  # TLS settings for gateway
    # enabled: false                       # Enable or disable TLS
    # secretName: ""                       # TLS secret name (if enabled)

## API token for authenticating with CSGHub API
hubAPIToken: ""

## Unique identifier for the origin cluster
originClusterID: ""

## Logging configuration
logging:
  level: "info"                            # Log level: info, warning, debug, error

#################################################################
##  Runner Configuration                                       ##
#################################################################
## Defined resource name
name: "runner"

## Service Configuration
service:
  type: "ClusterIP"                        # Service type: ClusterIP, NodePort, LoadBalancer
  port: 8082                               # Service port
  protocol: "TCP"                          # Network protocol

## Runner operation and communication
region: "region-0"                     # Region the runner belongs to
interval: 60                           # Communication interval with server (seconds)

## Namespace management
namespace: "spaces"                    # Namespace for user-deployed workloads
autoConfigure: true                    # Automatically install knative/argo/lws
kymlMode: create                       # Kubernetes resource: create, update, replace
mergingNamespace: "disable"            # Namespace merging: multi, single, disable

## Networking configuration
usePublicDomain: true                  # Use public domain for application access

## Package and image management
pipIndexUrl: "https://pypi.tuna.tsinghua.edu.cn/simple/"  # Custom pip repository
extraBuildArgs: []                     # Extra Kaniko build arguments
model:                                 # Model image configuration
  deployTimeout: "60"                  # Timeout (in seconds) for model deployment operations
  registry: ""                         # Custom image registry for model-related images (empty uses global registry)

## GPU resource configuration
gpuModelLabel:
  typeLabel: "nvidia.com/gpu.product"  # GPU type label
  capacityLabel: "nvidia.com/gpu"      # GPU capacity label

## Knative networking configuration
## e.g. http://<load balancer ip> or http://kourier-internal.kourier-system.svc.cluster.local
applicationEndpoint: ""

## Host network interface name used for intern communication during distributed (LWS) inference
## e.g. eth0
networkInterface: ""

## Kubernetes StorageClass name for persistent volume provisioning for space
# Example values: "local-path", "gp2"
storageClassName: ""

## Knative Serving configuration
knative:
  serving:
    domain: "example.com"              # Domain suffix for Knative services

    ## Deprecated configuration (for backward compatibility)
    services: []
      # - type: "LoadBalancer"           # Service type: LoadBalancer or NodePort
      #   domain: "example.com"          # Internal service domain
      #   host: "192.168.18.10"        # API server host address
      #   port: "30213"                # NodePort value when type=NodePort

## RBAC Configuration
rbac:
  create: true                         # Create SA, Role, RoleBinding, ClusterRole, ClusterRoleBinding
  serviceAccountName: "runner-admin"   # serviceAccountName created by rbac

## Logcollector Configuration
logcollector:
  enabled: false

  ## Logging Integration Configuration
  loki:
    address: ""

## Trace Logging Configuration
tempo:
  address: ""

## Registry Configuration
registry: {}
  # registry: ""                           # External registry URL
  # repository: "csghub"                   # Repository namespace
  # username: ""                           # Registry username
  # password: ""                           # Registry password
  # insecure: "false"                      # Disable TLS/SSL encryption

## ObjectStore Configuration
objectStore: {}                            # External object storage
  # endpoint: ""                           # Object storage endpoint URL
  # accessKey: ""                          # Access key for authentication
  # secretKey: ""                          # Secret key for authentication
  # bucket: "csghub-runner"                # Bucket name
  # region: ""                             # Storage region
  # secure: "false"                        # Use secure TLS certificates
  # encrypt: "false"                       # Enable TLS encryption
  # pathStyle: "true"                      # Use path-style addressing

## Pod Metadata
podAnnotations: {}
## Example: { "prometheus.io/scrape": "true", "prometheus.io/port": "9090" }

podLabels: {}
## Example: { "app.kubernetes.io/component": "runner", "environment": "production" }

## Security Contexts
podSecurityContext: {}
## Example: { fsGroup: 2000, runAsNonRoot: true, runAsUser: 1000 }

securityContext: {}
  ## Example:
  # capabilities:
  #   drop: ["ALL"]
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

## Environment Variables
environments: {}
## Example: { DEBUG: "false", MAX_WORKERS: "10", TIMEOUT: "300" }

## Deployment Annotations
annotations: {}
## Example: { "reloader.stakater.com/auto": "true" }

## Resource Quota enabled
resourceQuota:
  enabled: false

## Resource Requests and Limits
resources: {}
  ## Example:
  # requests:
  #   memory: "256Mi"
  #   cpu: "250m"
  # limits:
  #   memory: "512Mi"
  #   cpu: "500m"

## Node Scheduling Configuration
nodeSelector: {}
## Example: { "node-type": "compute-optimized", "gpu": "true" }

tolerations: []
  ## Example:
  # - key: "dedicated"
  #   operator: "Equal"
  #   value: "csghub"
  #   effect: "NoSchedule"

affinity: {}
  ## Example:
  # podAntiAffinity:
  #   preferredDuringSchedulingIgnoredDuringExecution:
  #   - weight: 100
  #     podAffinityTerm:
  #       labelSelector:
  #         matchExpressions:
  #         - key: "app"
  #           operator: "In"
  #           values: ["runner"]
  #       topologyKey: "kubernetes.io/hostname"

#################################################################
##  Dependent SubCharts Configuration                          ##
##  PLEASE DO NOT UPDATE!!!                                    ##
#################################################################
## Do not modify it unless you know the purpose of the modification.

## Reloader configuration
reloader:
  image:
    name: "opencsghq/stakater-reloader"    # Reloader image name

## Prometheus monitoring configuration
prometheus:
  enabled: true                            # Enable Prometheus

  gateway:
    enabled: false                         # Enable gateway for Prometheus
    basicAuth: {}                          # Basic authentication
      # username: "prometheus"
      # password: ""

  server:
    remoteWrite: []
