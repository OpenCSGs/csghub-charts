suite: Test External Infra Resources
templates:
  - configmap.yaml
release:
  name: csghub
  namespace: csghub
set:
  global:
    postgresql:
      enabled: false
      external:
        host: "10.6.0.10"
        port: 6432
        user: "postgres"
        password: "Postgres2025"
        sslmode: "prefer"
    redis:
      enabled: false
      external:
        host: "10.6.0.11"
        port: 6380
        password: "Redis2025"
tests:
  - it: Should render ConfigMap for external correctly
    template: configmap.yaml
    asserts:
      - equal:
          path: data["DATABASE_TYPE"]
          value: "postgresql"
      - equal:
          path: data["DATABASE_HOST"]
          value: "10.6.0.10"
      - equal:
          path: data["DATABASE_PORT"]
          value: "6432"
      - equal:
          path: data["DATABASE_USERNAME"]
          value: "postgres"
      - equal:
          path: data["DATABASE_PASSWORD"]
          value: "Postgres2025"
      - equal:
          path: data["DATABASE_NAME"]
          value: "csghub_csgship"
      - equal:
          path: data["REDIS_URL"]
          value: ":@10.6.0.11"
      - equal:
          path: data["REDIS_PORT"]
          value: "6380"
