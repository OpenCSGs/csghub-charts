#################################################################
##  Global Configuration                                       ##
#################################################################
global:
  ## Gateway configuration
  gateway:
    ## GatewayClass controller that will reconcile Gateway / HTTPRoute resources.
    ## Choose the controller according to the Gateway implementation you use.
    ## Examples:
    ## - gateway.envoyproxy.io/gatewayclass-controller  (Envoy Gateway)
    ## - istio.io/gateway-controller                    (Istio)
    ## - io.cilium/gateway-controller                   (Cilium)
    controllerName: gateway.envoyproxy.io/gatewayclass-controller

    ## Gateway service configuration
    ## type: Service type (LoadBalancer or NodePort)
    ## nodePorts: Optional NodePort mapping (if using NodePort)
    service:
      type: "LoadBalancer"          # Service type: LoadBalancer or NodePort
      nodePorts: {}
        # http: 30080
        # https: 30443
        # gitssh: 30022

    ## Base external domain used to expose CSGHub services
    external:
      domain: "csghub.example.com"  # e.g. csghub.example.com, example.com
        # public: ""                  # Optional public access domain override.
        # If empty, the domain will be derived automatically.
        # NOTE: When base domain is a second-level domain (e.g. example.com),
        # a subdomain (e.g. csghub.example.com) will be used internally
        # to avoid overly broad wildcard routing such as *.example.com

    ## TLS/SSL configuration for Gateway
    tls:
      enabled: false                # Enable TLS termination on the Gateway
      # secretName: ""              # Kubernetes TLS secret name (required if TLS is enabled)

  ## Image management
  image:
    registry: "docker.io"           # Image global registry, opencsg-registry.cn-beijing.cr.aliyuncs.com for mainland
    registryPolicy: "default"       # default or force, force will overwrite all others registries
    tag: "v1.11.0"                  # Image tag format: {{version}}-{{edition}}
    pullPolicy: "IfNotPresent"      # Image pull policy: Always, IfNotPresent, Never
    pullSecrets: []                 # Private registry authentication secrets

  ## Persistent volume configuration
  persistence:
    # storageClass: ""              # StorageClass name (empty for default)
    accessModes: ["ReadWriteOnce"]  # Volume access modes
    size: "10Gi"                    # Default storage capacity

  ## Database configuration
  postgresql:
    ## Use built-in (true) or external (false)
    enabled: true
    ## External PostgreSQL connection
    external: {}
      # host: "<pg_host>"           # PostgreSQL host address
      # port: 6432                  # PostgreSQL port
      # user: "csghub"              # Database username
      # password: ""                # Database password
      # timezone: "Etc/UTC"         # Database timezone
      # sslmode: "prefer"           # SSL mode

  ## Redis configuration
  redis:
    ## Use built-in (true) or external (false)
    enabled: true
    ## External Redis configuration
    external: {}
      # host: "<redis_host>"        # Redis server hostname or IP
      # port: 6379                  # Redis port number
      # password: ""                # Redis authentication password

  ## subChart deployment context
  chartContext:
    isBuiltIn: false                # deployed bundled with csghub

#################################################################
##  CSGShip Configuration                                      ##
#################################################################
## External CSGHub URL for accessing the hub interface
externalUrl: "https://csghub.example.com"

## API token for authenticating with CSGHub API
hubAPIToken: ""

## Global image configuration
image:
  # registry: "docker.io"                    # Docker registry
  repository: "opencsghq/csgship-web"
  tag: "v0.4.0"                            # Image version tag
  pullPolicy: "IfNotPresent"               # Image pull policy: Always, IfNotPresent, Never
  pullSecrets: []                          # Docker registry secrets

## Web Configuration
web:
  name: "csgship"

  ## Image settings (overrides global.image)
  image: {}

  ## Gateway configuration
  gateway:
    enabled: true                            # Enable or disable gateway
    tls: {}                                  # TLS settings for gateway
      # enabled: false                       # Enable or disable TLS
      # secretName: ""                       # TLS secret name (if enabled)

  ## GitLab OAuth configuration
  ## It should be a GitLab Applicaition with following info:
  ## Name: CSGShip
  ## Redirect URI: http://casdoor.example.com/callback
  ## Scope: read_user, openid, profile, email
  oauth: {}
    # issuer: "https://git-devops.opencsg.com"
    # clientId: "9c56ec399c70448b498a56c2dd3e2effb89453d4591a67ea98b4555f2a70b05e"
    # clientSecret: "gloas-3213761365be0a52bb5f5b92d5fbf4afe474afc6d2464f97dc2e1ae274d65b8b"

  ## Database configuration
  postgresql: {}
    # host: "<pg_host>"                    # PostgreSQL host address
    # port: 5432                           # PostgreSQL port
    # database: "csgship_csgship"          # Database name
    # user: "csghub"                       # Database username
    # password: ""                         # Database password
    # timezone: "Etc/UTC"                  # Database timezone
    # sslmode: "prefer"                    # SSL mode

  ## Redis configuration
  redis: {}
    # host: "<redis_host>"                 # Redis server hostname or IP
    # port: 6379                           # Redis port number
    # password: ""                         # Redis authentication password

  persistence: {}
    # storageClass: ""                     # StorageClass for dynamic provisioning
    # accessModes: ["ReadWriteMany"]       # Volume access permissions
    # size: "10Gi"                         # Disk space allocation

## Agentic Configuration
agentic:
  image:
    repository: "opencsghq/csgship-agentic"
    tag: "v0.4.0"

## Billing Configuration
billing:
  image:
    repository: "opencsghq/csgship-billing"
    tag: "bl-2.0.1"

  ## Nats Configuration for billing
  nats: {}
    # host: "<nats_host>"         # Nats server hostname or IP
    # port: 6379                  # Nats port number
    # user: ""                    # Nats authentication user
    # password: ""                # Nats authentication password

## Frontend Configuration
frontend:
  image:
    repository: "opencsghq/csgship-portal"
    tag: "v1.2.1"

## MegaLinter Server Configuration
megalinterServer:
  image:
    repository: "oxsecurity/megalinter-server"
    tag: "beta"

## MegaLinter Worker Configuration
megalinterWorker:
  image:
    repository: "oxsecurity/megalinter-worker"
    tag: "v8.0.0"

## SecScan Configuration
secscan:
  image:
    repository: "opencsghq/csgship-secscan"
    tag: "sec-2.0.0"

#################################################################
##  Built-in Third-party Components                            ##
#################################################################
## Embedded PostgreSQL configuration
postgresql:
  image:
    # registry: "docker.io"
    repository: "opencsghq/postgres"
    tag: "15.17"                             # Image version tag
    pullPolicy: "IfNotPresent"               # Image pull policy
    pullSecrets: []                          # Docker registry secrets

  service:
    type: "ClusterIP"                        # Service type: ClusterIP, NodePort, LoadBalancer
    port: 5432                               # Service port
    protocol: "TCP"                          # Network protocol

  databases:                                 # Databases to create on startup
    - "csghub_csgship"
    - "csghub_casdoor"

  parameters: {}                             # PostgreSQL runtime parameters
    # max_connections: 400                   # Dynamic parameters (triggers recreate)
    # shared_buffers: "128MB"                # Shared memory buffers

  persistence:
    # storageClass: ""                       # StorageClass for dynamic provisioning
    # accessModes: ["ReadWriteOnce"]         # Volume access permissions
    size: "50Gi"                             # Disk space allocation

## Built-in Redis configuration
redis:
  image:
    # registry: "docker.io"
    repository: "redis"
    tag: "7.2.5"                             # Image version tag
    pullPolicy: "IfNotPresent"               # Image pull policy
    pullSecrets: []                          # Docker registry secrets

  service:
    type: "ClusterIP"                        # Service type: ClusterIP, NodePort, LoadBalancer
    port: 6379                               # Service port
    protocol: "TCP"                          # Network protocol

  requirePass: false                         # Password requirement

  persistence:
    # storageClass: ""                       # StorageClass for dynamic provisioning
    # accessModes: ["ReadWriteOnce"]         # Volume access permissions
    size: "10Gi"                             # Disk space allocation

## Built-in Casdoor configuration
casdoor:
  admin: {}                                  # Initial admin user
    # name: "root"                           # Admin username
    # password: ""                           # Admin password

  image:
    # registry: "docker.io"
    repository: "casbin/casdoor"
    tag: "v2.79.0"                           # Image version tag
    pullPolicy: "IfNotPresent"               # Image pull policy
    pullSecrets: []                          # Docker registry secrets

  service:
    type: "ClusterIP"                        # Service type: ClusterIP, NodePort, LoadBalancer
    port: 8000                               # Service port
    protocol: "TCP"                          # Network protocol

  gateway:
    enabled: true                            # Enable or disable gateway
    tls: {}                                  # TLS settings
      # enabled: false                       # Enable or disable TLS
      # secretName: ""                       # TLS secret name

  postgresql: {}                             # Database configuration
    # host: "<pg_host>"                      # PostgreSQL host address
    # port: 5432                             # PostgreSQL port
    # database: "csghub_casdoor"             # Database name
    # user: "csghub"                         # Database username
    # password: ""                           # Database password
    # timezone: "Etc/UTC"                    # Database timezone
    # sslmode: "prefer"                      # SSL mode

#################################################################
##  Dependent SubCharts                                        ##
##  PLEASE DO NOT UPDATE!!!                                    ##
#################################################################
## Do not modify it unless you know the purpose of the modification.

## Reloader configuration
reloader:
  image:
    name: "opencsghq/stakater-reloader"    # Reloader image name
