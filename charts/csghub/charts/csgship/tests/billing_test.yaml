suite: Test Billing ConfigMap
templates:
  - billing/configmap.yaml
release:
  name: csghub
  namespace: csghub
set:
  billing:
    enabled: true
tests:
  - it: Should render configmap correctly
    template: billing/configmap.yaml
    asserts:
      - equal:
          path: metadata.name
          value: "csghub-billing"
      - equal:
          path: metadata.labels["app.kubernetes.io/service"]
          value: "billing"
      - matchRegex:
          path: data["config.sh"]
          pattern: |-
            .*http://csghub-csgship:8000/api/v1/platforms/
