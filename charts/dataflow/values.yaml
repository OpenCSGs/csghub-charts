#################################################################
##  Global Configuration                                       ##
#################################################################
global:
  ## Gateway configuration
  gateway:
    ## GatewayClass controller that will reconcile Gateway / HTTPRoute resources.
    ## Choose the controller according to the Gateway implementation you use.
    ## Examples:
    ## - gateway.envoyproxy.io/gatewayclass-controller  (Envoy Gateway)
    ## - istio.io/gateway-controller                    (Istio)
    ## - io.cilium/gateway-controller                   (Cilium)
    controllerName: gateway.envoyproxy.io/gatewayclass-controller

    ## Gateway service configuration
    ## type: Service type (LoadBalancer or NodePort)
    ## nodePorts: Optional NodePort mapping (if using NodePort)
    service:
      type: "LoadBalancer"          # Service type: LoadBalancer or NodePort
      nodePorts: {}
        # http: 30080
        # https: 30443
        # gitssh: 30022

    ## Base external domain used to expose CSGHub services
    external:
      domain: "csghub.example.com"  # e.g. csghub.example.com, example.com
        # public: ""                  # Optional public access domain override.
        # If empty, the domain will be derived automatically.
        # NOTE: When base domain is a second-level domain (e.g. example.com),
        # a subdomain (e.g. csghub.example.com) will be used internally
        # to avoid overly broad wildcard routing such as *.example.com

    ## TLS/SSL configuration for Gateway
    tls:
      enabled: false                # Enable TLS termination on the Gateway
      # secretName: ""              # Kubernetes TLS secret name (required if TLS is enabled)

  ## Deprecated Section
  ## Image management
  image:
    registry: "docker.io"           # Image global registry, opencsg-registry.cn-beijing.cr.aliyuncs.com for mainland
    registryPolicy: "default"       # default or force, force will overwrite all others registries
    tag: "v1.16.0"                  # Image tag format: {{version}}-{{edition}}
    pullPolicy: "IfNotPresent"      # Image pull policy: Always, IfNotPresent, Never
    pullSecrets: []                 # Private registry authentication secrets

  ## Persistent volume configuration
  persistence:
    # storageClass: ""              # StorageClass name (empty for default)
    accessModes: ["ReadWriteOnce"]  # Volume access modes
    size: "10Gi"                    # Default storage capacity

  ## Database configuration
  postgresql:
    ## Use built-in (true) or external (false)
    enabled: true
    ## External PostgreSQL connection
    external: {}
      # host: "<pg_host>"           # PostgreSQL host address
      # port: 6432                  # PostgreSQL port
      # user: "csghub"              # Database username
      # password: ""                # Database password
      # timezone: "Etc/UTC"         # Database timezone
      # sslmode: "prefer"           # SSL mode

  ## Redis configuration
  redis:
    ## Use built-in (true) or external (false)
    enabled: true
    ## External Redis configuration
    external: {}
      # host: "<redis_host>"        # Redis server hostname or IP
      # port: 6379                  # Redis port number
      # password: ""                # Redis authentication password

  ## MongoDB configuration
  mongo:
    ## Use built-in (true) or external (false)
    enabled: true
    ## External Mongo configuration
    external: {}
      # host: "<mongo_host>"        # Mongo server hostname or IP
      # port: 27017                 # Mongo  port number
      # user: "root"                # Mongo authentication user
      # password: ""                # Mongo authentication password

  ## SubChart deployment context
  chartContext:
    isBuiltIn: false                     # deployed bundled with csghub

#################################################################
##  Dataflow Configuration                                     ##
#################################################################
## External CSGHub URL for accessing the hub interface
externalUrl: "https://csghub.example.com"

## Dataflow Configuration
dataflow:
  ## Image settings (overrides global.image)
  image:
    # registry: "docker.io"
    repository: "opencsghq/dataflow"
    tag: "v1.16.0"                          # Image version tag
    pullPolicy: "IfNotPresent"              # Image pull policy
    pullSecrets: []                         # Docker registry secrets

  ## Gateway configuration
  gateway:
    enabled: true                            # Enable or disable gateway
    tls: {}                                  # TLS settings for gateway
      # enabled: false                       # Enable or disable TLS
      # secretName: ""                       # TLS secret name (if enabled)

  ## Database configuration
  postgresql: {}
    # host: "<pg_host>"                    # PostgreSQL host address
    # port: 5432                           # PostgreSQL port
    # database: "csghub_dataflow"          # Database name
    # user: "csghub"                       # Database username
    # password: ""                         # Database password
    # timezone: "Etc/UTC"                  # Database timezone
    # sslmode: "prefer"                    # SSL mode

  ## Redis configuration
  redis: {}
    # host: "<redis_host>"                 # Redis server hostname or IP
    # port: 6379                           # Redis port number
    # password: ""                         # Redis authentication password

  ## MongoDB Configuration
  mongo: {}
    # host: "<mongo_host>"        # Mongo server hostname or IP
    # port: 27017                 # Mongo  port number
    # user: "root"                # Mongo authentication user
    # password: ""                # Mongo authentication password

  persistence:
    # storageClass: ""                       # StorageClass for dynamic provisioning
    accessModes: ["ReadWriteMany"]            # Volume access permissions
    size: "100Gi"                            # Disk space allocation

## Celery Worker Configuration
worker:
  ## Logging configuration
  logging:
    level: "info"

## Label Studio Configuration
labelStudio:
  ## Image settings (overrides global.image)
  image:
    # registry: "docker.io"
    repository: "opencsghq/label-studio"
    tag: "v1.16.0"                            # Image version tag
    pullPolicy: "IfNotPresent"               # Image pull policy
    pullSecrets: []                          # Docker registry secrets

  ## Gateway configuration
  gateway:
    enabled: true                            # Enable or disable gateway
    tls: {}                                  # TLS settings for gateway
      # enabled: false                       # Enable or disable TLS
      # secretName: ""                       # TLS secret name (if enabled)

  ## Database configuration
  postgresql: {}
    # host: "<pg_host>"                    # PostgreSQL host address
    # port: 5432                           # PostgreSQL port
    # database: "csghub_label_studio"      # Database name
    # user: "csghub"                       # Database username
    # password: ""                         # Database password
    # timezone: "Etc/UTC"                  # Database timezone
    # sslmode: "prefer"                    # SSL mode

  persistence: {}
    # storageClass: ""                       # StorageClass for dynamic provisioning
    # accessModes: ["ReadWriteMany"]         # Volume access permissions
    # size: "100Gi"                          # Disk space allocation

  securityContext:
    runAsUser: 0
    runAsGroup: 0

#################################################################
##  Built-in Third-party Components                            ##
#################################################################
## Embedded PostgreSQL configuration
postgresql:
  image:
    registry: "docker.io"
    repository: "opencsghq/postgres"
    tag: "15.10"                             # Image version tag
    pullPolicy: "IfNotPresent"               # Image pull policy
    pullSecrets: []                          # Docker registry secrets

  service:
    type: "ClusterIP"                        # Service type: ClusterIP, NodePort, LoadBalancer
    port: 5432                               # Service port
    protocol: "TCP"                          # Network protocol

  databases:                                 # Databases to create on startup
    - "csghub_dataflow"
    - "csghub_label_studio"

  parameters: {}                             # PostgreSQL runtime parameters
    # max_connections: 400                   # Dynamic parameters (triggers recreate)
    # shared_buffers: "128MB"                # Shared memory buffers

  persistence:
    # storageClass: ""                       # StorageClass for dynamic provisioning
    # accessModes: ["ReadWriteOnce"]         # Volume access permissions
    size: "50Gi"                             # Disk space allocation

## Built-in Redis configuration
redis:
  image:
    # registry: "docker.io"
    repository: "redis"
    tag: "7.2.5"                             # Image version tag
    pullPolicy: "IfNotPresent"               # Image pull policy
    pullSecrets: []                          # Docker registry secrets

  service:
    type: "ClusterIP"                        # Service type: ClusterIP, NodePort, LoadBalancer
    port: 6379                               # Service port
    protocol: "TCP"                          # Network protocol

  requirePass: false                         # Password requirement

  persistence:
    # storageClass: ""                       # StorageClass for dynamic provisioning
    # accessModes: ["ReadWriteOnce"]         # Volume access permissions
    size: "10Gi"                             # Disk space allocation

## Built-in MongoDB configuration
mongo:
  image:
    # registry: "docker.io"
    repository: "opencsghq/mongo"
    tag: "8.0.12"                            # Image version tag
    pullPolicy: "IfNotPresent"               # Image pull policy
    pullSecrets: []                          # Docker registry secrets

  service:
    type: "ClusterIP"                        # Service type: ClusterIP, NodePort, LoadBalancer
    port: 27017                              # Service port
    protocol: "TCP"                          # Network protocol

  auth: {}
    # user: "root"                           # user for authentication
    # password: ""                           # Password for authentication

  persistence:
    # storageClass: ""                       # StorageClass for dynamic provisioning
    # accessModes: ["ReadWriteOnce"]         # Volume access permissions
    size: "10Gi"                             # Disk space allocation

#################################################################
##  Dependent SubCharts                                        ##
##  PLEASE DO NOT UPDATE!!!                                    ##
#################################################################
## Do not modify it unless you know the purpose of the modification.

## Reloader configuration
reloader:
  image:
    name: "opencsghq/stakater-reloader"    # Reloader image name
